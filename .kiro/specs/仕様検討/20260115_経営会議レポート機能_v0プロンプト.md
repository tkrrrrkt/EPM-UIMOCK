# v0プロンプト：経営会議レポート機能

## プロジェクト概要

EPM（Enterprise Performance Management）SaaSの「経営会議レポート機能」UIを作成してください。

この機能は、月次経営会議・取締役会・事業部内会議の**準備→実施→記録**を支援する会議運営プラットフォームです。

---

## デザインシステム（必ず準拠）

### カラーパレット

**プライマリー（Deep Teal）**
- Primary 500: `#14b8a6` - メインプライマリー
- Primary 600: `#0d9488` - ホバー

**セカンダリー（Royal Indigo）**
- Secondary 500: `#6366f1` - メインセカンダリー
- Secondary 600: `#4f46e5` - ホバー

**セマンティック**
- Success: `#22c55e` - 完了、達成
- Warning: `#f59e0b` - 警告、注意
- Error: `#ef4444` - エラー、未達
- Info: `#3b82f6` - 情報

**ニュートラル**
- 背景: `#fafafa`, `#f5f5f5`
- ボーダー: `#e5e5e5`, `#d4d4d4`
- テキスト: `#262626`（メイン）, `#525252`（セカンダリー）, `#737373`（補助）

### コンポーネント規約

- **shadcn/ui** を使用（Button, Card, Table, Tabs, Badge, Dialog, Select, Input, Textarea, Progress等）
- 角丸: カード/モーダルは `rounded-lg`、ボタン/インプットは `rounded-md`
- シャドウ: カードは `shadow` または `shadow-md`、モーダルは `shadow-lg`
- スペーシング: Tailwindスケール使用（`p-4`, `p-6`, `gap-4`, `gap-6`）
- フォント: `font-sans`（本文）、`font-mono`（数値）
- アイコン: `lucide-react`、標準サイズ `h-4 w-4`

---

## 作成する画面一覧

### Phase 1: 会議運営系（B系）

#### B1: 会議イベント一覧
- 目的: 会議イベントの一覧表示、フィルタ、新規作成への導線
- 要素:
  - ヘッダー（タイトル「経営会議管理」、新規作成ボタン）
  - フィルタバー（会議種別、ステータス、対象期間）
  - テーブル（イベントコード、会議名、会議種別、対象月、ステータス、締切日、会議日、アクション）
  - ステータスバッジ: DRAFT（グレー）、OPEN（プライマリー）、COLLECTING（ワーニング）、DISTRIBUTED（セカンダリー）、HELD（インフォ）、CLOSED（サクセス）
- UXポイント:
  - 行クリックで詳細画面へ遷移
  - ステータスで色分け、一目でわかる

#### B2: 会議イベント作成/編集
- 目的: 新規会議の設定、既存会議の編集
- 要素:
  - ステップウィザード形式（1.基本情報 → 2.日程設定 → 3.確認）
  - Step1: 会議種別選択（カード形式）、会議名、対象年度、対象月選択
  - Step2: 報告締切日、事前展開日、会議日（DatePicker）、見込イベント連携（任意）
  - Step3: 設定内容確認サマリー、作成ボタン
- UXポイント:
  - 会議種別選択時にプレビュー（対象部門数、フォーム項目数）
  - バリデーションメッセージ表示

#### B3: 登録状況管理
- 目的: 部門からの報告提出状況の管理、催促
- 要素:
  - サマリーカード（提出済/未提出の件数、進捗率プログレスバー）
  - 部門一覧テーブル（部門名、担当者、ステータス、最終更新日、アクション）
  - ステータス: 未着手（グレー）、下書き中（ワーニング）、提出済（サクセス）
  - 一括催促ボタン、個別催促ボタン
- UXポイント:
  - 未提出が多い場合は警告表示
  - 締切日との残り日数を表示

#### B4: 会議クローズ
- 目的: 会議終了後のステータス変更、スナップショット取得
- 要素:
  - 現在のステータス表示、次ステータスへの遷移ボタン
  - スナップショット取得確認ダイアログ
  - 未提出部門がある場合の警告

#### B5: 議事録登録
- 目的: 議事録本文の編集、添付ファイルアップロード
- 要素:
  - リッチテキストエディタ（Textarea でシンプルに）
  - 添付ファイルアップロード（ドラッグ&ドロップ対応）
  - アップロード済みファイル一覧
  - 保存ボタン

---

### Phase 2: 報告登録系（C系）

#### C1: 報告登録（部門用）
- 目的: 部門担当者による報告フォーム入力
- 要素:
  - 会議情報ヘッダー（会議名、対象月、締切日）
  - セクション別フォーム:
    - 業績サマリー: SELECT（好調/計画通り/懸念/要対策）、TEXTAREA
    - 差異要因: TEXTAREA（引用ボタン付き）
    - リスク・課題: TEXTAREA
    - アクション: TEXTAREA
    - 添付資料: FILE（複数可）
  - 下書き保存ボタン、提出ボタン
- UXポイント:
  - 見通しSELECTは色付きで直感的に選択
  - 引用機能: ボタンクリックで見込コメントをテキストに挿入
  - 必須項目は＊マーク、未入力時にエラー表示

#### C2: 報告登録（事業部用）
- 目的: 事業部長による下位報告の参照・引用・サマリー入力
- 要素:
  - 左側: 下位部門の報告一覧（アコーディオン形式）
  - 右側: 入力フォーム（C1と同様）
  - 引用機能: 下位報告のテキストを選択して引用ボタンで挿入
- UXポイント:
  - 2カラムレイアウト
  - 下位報告を見ながら入力できる

#### C3: 報告確認
- 目的: 提出済み報告の閲覧、締切前の編集
- 要素:
  - 提出済みフラグ表示
  - 各セクションの入力内容表示
  - 締切前なら「編集」ボタン表示

---

### Phase 3: レポート閲覧系（D系）

#### D1: 経営会議レポート（メイン）
- 目的: 会議用レポートのメイン画面、タブ切替
- 要素:
  - 会議情報ヘッダー（会議名、対象月、ステータス）
  - タブナビゲーション: サマリー | 詳細分析 | 部門報告 | KPI・アクション | 議事録
- UXポイント:
  - タブは `TabsList` + `TabsContent` で実装
  - URL連動（`?tab=summary` など）

#### D2: エグゼクティブサマリー（タブ内）
- 目的: KPIカード、主要指標の一覧表示
- 要素:
  - KPIカード（4列グリッド）
    - 売上、粗利、営業利益、見込達成率
    - 予算 vs 実績+見込 の達成率表示
    - 達成: サクセス、未達: エラー、警告: ワーニング
  - ウォーターフォールチャート（概念的な積み上げバー）
  - 要注目事項リスト（予算差異TOP3、前回見込差異TOP3）
  - 既存レポートへのリンクボタン（差異分析、予算実績照会）
- UXポイント:
  - カードクリックで詳細へ遷移
  - 視覚的なインパクト（大きな数字、色分け）

#### D4: 部門報告閲覧（タブ内）
- 目的: 各部門からの報告を階層的に表示
- 要素:
  - 部門ツリー（左サイドバー、ツリービュー）
  - 選択部門の報告内容（右側メイン）
    - セクション別に折りたたみ表示
    - 見通しSELECTは色付きバッジ
    - 添付ファイル一覧
- UXポイント:
  - 部門選択で右側が切り替わる
  - 階層構造（会社→事業部→部門）が視覚的にわかる

#### D5: KPI・アクション（タブ内）
- 目的: KPI達成状況、アクションプラン進捗の表示
- 要素:
  - 部門選択タブ（全社 | X事業部 | Y事業部 ...）
  - KPIカード一覧（4列グリッド）
    - KPI名、現在値、目標値、達成状況アイコン
    - クリックで詳細遷移リンク
  - アクションプラン進捗カード
    - プラン名、担当者、期限、進捗バー
    - ガント/カンバン遷移リンク
  - 会議アクション追加ボタン
- UXポイント:
  - 部門切替でコンテンツが変わる
  - 進捗バーで視覚的に状況把握

#### D6: アクション管理（タブ内 or 別画面）
- 目的: 会議で決定したアクションの一覧管理
- 要素:
  - アクション一覧テーブル（No、タイトル、担当部門、担当者、期限、ステータス、リンク先）
  - ステータス: OPEN（グレー）、IN_PROGRESS（セカンダリー）、COMPLETED（サクセス）、CANCELLED（エラー）
  - 新規アクション追加ダイアログ
  - ステータス変更ドロップダウン

#### D7: 前回比較（タブ内）
- 目的: 前回会議との数値比較
- 要素:
  - 比較テーブル（科目、前回会議時、今回会議時、差分）
  - 差分セル: プラス（サクセス）、マイナス（エラー）

#### D8: 議事録閲覧（タブ内）
- 目的: 議事録本文、添付ファイルの閲覧
- 要素:
  - 議事録本文（マークダウン or プレーンテキスト表示）
  - 添付ファイル一覧（ダウンロードリンク）
  - 記録日時、記録者表示

---

## モックデータ構造（BFF DTO準拠）

### MeetingEvent（会議イベント）
```typescript
interface MeetingEvent {
  id: string
  eventCode: string
  eventName: string
  meetingTypeId: string
  meetingTypeName: string
  targetPeriodId: string
  targetPeriodName: string // "2026年6月度"
  targetFiscalYear: number
  status: 'DRAFT' | 'OPEN' | 'COLLECTING' | 'DISTRIBUTED' | 'HELD' | 'CLOSED' | 'ARCHIVED'
  submissionDeadline: string // ISO date
  distributionDate?: string
  meetingDate?: string
  reportLayoutId?: string
  notes?: string
  minutesText?: string
  minutesRecordedAt?: string
  minutesRecordedBy?: string
  createdAt: string
  updatedAt: string
}
```

### MeetingSubmission（部門報告）
```typescript
interface MeetingSubmission {
  id: string
  meetingEventId: string
  submissionLevel: 'DEPARTMENT' | 'BU' | 'COMPANY'
  departmentStableId?: string
  departmentName?: string
  status: 'DRAFT' | 'SUBMITTED'
  submittedAt?: string
  submittedBy?: string
  values: MeetingSubmissionValue[]
}

interface MeetingSubmissionValue {
  id: string
  fieldId: string
  fieldCode: string
  fieldName: string
  fieldType: 'TEXT' | 'TEXTAREA' | 'NUMBER' | 'SELECT' | 'MULTI_SELECT' | 'DATE' | 'FILE'
  valueText?: string
  valueNumber?: number
  valueDate?: string
  valueJson?: any
}
```

### SubmissionStatus（提出状況）
```typescript
interface SubmissionStatus {
  departmentStableId: string
  departmentName: string
  status: 'NOT_STARTED' | 'DRAFT' | 'SUBMITTED'
  lastUpdatedAt?: string
  lastUpdatedBy?: string
}
```

### KpiCard（KPIカード表示用）
```typescript
interface KpiCard {
  subjectId: string
  subjectName: string
  budget: number
  actual: number
  forecast: number
  achievementRate: number // (actual + forecast) / budget * 100
  status: 'SUCCESS' | 'WARNING' | 'ERROR'
}
```

### MeetingAction（会議アクション）
```typescript
interface MeetingAction {
  id: string
  actionNo: number
  actionTitle: string
  actionDetail?: string
  ownerDepartmentName?: string
  ownerEmployeeName?: string
  dueDate?: string
  status: 'OPEN' | 'IN_PROGRESS' | 'COMPLETED' | 'CANCELLED'
  linkedKpiSubjectId?: string
  linkedActionPlanId?: string
}
```

---

## BffClient インターフェース

```typescript
interface MeetingBffClient {
  // 会議イベント
  getMeetingEvents(params: { companyId: string; fiscalYear?: number; status?: string }): Promise<{ items: MeetingEvent[] }>
  getMeetingEvent(id: string): Promise<MeetingEvent>
  createMeetingEvent(data: CreateMeetingEventRequest): Promise<MeetingEvent>
  updateMeetingEvent(id: string, data: UpdateMeetingEventRequest): Promise<MeetingEvent>
  updateMeetingEventStatus(id: string, status: string): Promise<MeetingEvent>

  // 部門報告
  getSubmissionStatus(meetingEventId: string): Promise<{ items: SubmissionStatus[]; summary: { total: number; submitted: number } }>
  getSubmission(meetingEventId: string, departmentStableId: string): Promise<MeetingSubmission>
  saveSubmission(data: SaveSubmissionRequest): Promise<MeetingSubmission>
  submitSubmission(submissionId: string): Promise<MeetingSubmission>

  // レポート
  getKpiCards(meetingEventId: string, departmentStableId?: string): Promise<{ items: KpiCard[] }>
  getDepartmentReports(meetingEventId: string): Promise<{ items: DepartmentReport[] }>

  // アクション
  getMeetingActions(meetingEventId: string): Promise<{ items: MeetingAction[] }>
  createMeetingAction(data: CreateMeetingActionRequest): Promise<MeetingAction>
  updateMeetingActionStatus(id: string, status: string): Promise<MeetingAction>

  // 議事録
  saveMinutes(meetingEventId: string, data: { minutesText: string }): Promise<void>
  uploadMinutesAttachment(meetingEventId: string, file: File): Promise<Attachment>
  getMinutesAttachments(meetingEventId: string): Promise<{ items: Attachment[] }>
}
```

---

## 画面遷移フロー

```
B1 会議イベント一覧
├─ [新規作成] → B2 会議イベント作成
├─ [行クリック] → D1 経営会議レポート
│   ├─ [サマリータブ] → D2 エグゼクティブサマリー
│   ├─ [部門報告タブ] → D4 部門報告閲覧
│   ├─ [KPI・アクションタブ] → D5 KPI・アクション
│   │   └─ [アクション追加] → D6 アクション管理
│   ├─ [前回比較タブ] → D7 前回比較
│   └─ [議事録タブ] → D8 議事録閲覧
│       └─ [編集] → B5 議事録登録
├─ [登録状況] → B3 登録状況管理
│   └─ [部門行クリック] → C1/C2 報告登録
└─ [クローズ] → B4 会議クローズ

C1 報告登録（部門用）
└─ [提出後] → C3 報告確認

C2 報告登録（事業部用）
└─ [下位報告参照] → 左サイドバーで参照
```

---

## 実装優先順位

### Priority 1（まず動くMVP）
1. B1 会議イベント一覧
2. B2 会議イベント作成
3. C1 報告登録（部門用）
4. D1+D2 レポートメイン＋サマリー

### Priority 2（コア機能完成）
5. B3 登録状況管理
6. D4 部門報告閲覧
7. D5 KPI・アクション
8. B5 議事録登録 + D8 議事録閲覧

### Priority 3（拡張機能）
9. C2 報告登録（事業部用）
10. D6 アクション管理
11. D7 前回比較
12. B4 会議クローズ

---

## 出力要件

1. **ファイル構成**
   - `apps/web/_v0_drop/meeting-management/` 配下に配置
   - Next.js App Router形式
   - `app/` 配下にページ、`components/` 配下にコンポーネント

2. **必須ファイル**
   - `types.ts` - 型定義
   - `api.ts` - BffClient interface + MockBffClient実装
   - `mock-data.ts` - モックデータ
   - 各画面の `page.tsx` とコンポーネント

3. **スタイル**
   - Tailwind CSS + shadcn/ui
   - デザインシステムのカラー・スペーシング・コンポーネント規約を厳守

4. **日本語**
   - 全てのラベル・メッセージは日本語で

---

## 注意事項

- **ビジネスロジックはUIに持たせない**（BFFに委譲する前提）
- **fetch直書き禁止**（必ずBffClient経由）
- **任意の色値禁止**（デザインシステムのクラスを使用）
- **モックデータはDTO形状に厳密に合わせる**（将来のBFF接続のため）
